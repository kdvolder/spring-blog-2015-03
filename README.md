#Spring Boot STS Tutorial

Spring Tool Suite 3.6.4 was just released last week. This blog post is a tutorial demonstrating some of the new features STS provides to create and work with Spring Boot applications.

In this tutorial you'll learn how to:

   - create a Simple Spring Boot Application with STS
   - launch and debug your boot application from STS
   - use the new STS Properties editor to edit configuration properties.
   - use @ConfigurationProperties in your code to get the same editor support for your own configuration properties.
   
As this a fair amount of ground to cover, this article will be split into several posts. This post is part I and it deals with the first two points only. 

## Getting Started: Hello Boot

We use the "New Spring Starter" wizard to create a basic spring boot app. 

![menu-new-starter]

Spring boot provides so called 'starters'. A set of classpath dependencies and autoconfiguration that lets you get started without lots of spring configuration. We pick the 'web' starter as we'll build a simple 'Hello' rest service.

![new-starter-wizard]

The wizard is GUI frontend that, under the hood, uses the webservice at [start.spring.io] to generate some basic scaffolding. You could use the webservice directly yourself, download the zip it generates, unpack it, import it etc. Using the STS wizard does all of this at the click of a button and ensures the project is configured correctly so you can immediately start coding. 

After you click the finish button, your workspace will look something like this:

![workspace-ready]

The `HelloBootApplication` Java-main class generated by [start.spring.io] is the only code in our app at the moment. Thanks to the 'magic' of spring boot, and because we added the 'web' starter to our dependencies, this tiny piece of code is already a fully functional web server! It just doesn't have any real content yet. Before adding some content, let's learn how to run the app, and verify it *actually* runs in the process.

## Running a Boot App in STS

Spring boot apps created by the wizard come in two flavors 'jar' or 'war'. The Starter wizard let's you choose between them in its 'packaging' option. A great feature of spring-boot is that you can easily create standalone 'jar' packaged projects that contain a fully functional embedded web server. All you need to do to run your app, is run its Java Main type, just like you do any other plain Java application. This is a huge advantage as you don't have to mess around with setting up local or remote Tomcat servers, war-packaging and deploying. If you really want to do things 'the hard way' you can still choose 'war' packaging. However there's really no need to do so because:

 1. you can [convert your 'jar' app to a 'war'][convert-jar-to-war] app at any time 
 2. the [Cloud Foundry] platform directly supports deploying standalone boot jars

Now, if you understood what I just said, then you probably realize you don't actually need any 'special' tooling from STS to run the app locally. Just click on the Java Main type and select "Run As >> Java Application" and voila. Also all of your standard Eclipse Java debugging tools will 'just work'. However, STS provides a dedicated launcher that does basically the same thing but adds a few useful bells and whistles. So let's use that instead.

![run-as-boot]

Your app should start and you should see some output in the console view:

![console-output]

You can open your app running locally at http://localhost:8080. All you'll get is a `404` error page, but that is exactly as expected since we haven't yet added any real content to our app.

Now, what about the bells and whistles I promised? "Run As >> Boot App" is pretty much a plain Java launcher but provides some extra options to customize the launch configurations it creates. To see those options we need to open the "Launch Configuration Editor", accesible from the ![Debug] or ![Run] toolbar button:

![run-conf-menu]

If you've used the Java Launch Config Editor in Eclipse, this should look familiar. For a Boot Launch Configuration, the 'Main' tab is a little different and has some extra stuff. I won't discuss all of the extras, you can find out more in the [STS 3.6.4 release notes]. So let's just do something simple, for example, override the default http port '8080' to something else, like '8888'. You can probably guess that this can be done by setting a system property. In the 'pure' Java launcher you can set such properties via commandline arguments. But what, you might wonder, is the name of that property exactly "spring.port", "http.port", "spring.server.port"? Fortunately, the launch config editor helps. The "Override Properties" component provides some basic content assist. You just type 'port' and it makes a few suggestions:

![override-property]

Select `server.port` add the value '8888' in the right column and click "Run". 

If you followed the steps exactly upto this point, your launch probably terminates immediately with an exception:

    Error: Exception thrown by the agent : java.rmi.server.ExportException: Port already in use: 31196; nested exception is: 
	    java.net.BindException: Address already in use
	   
This may be a bit of a surprise, since we just changed our port didn't we? Actually the port conflict here is not from the http port but a JMX port used to enable "Live Bean Graph Support" (I won't discuss this feature in this Blog post, see [STS 3.6.4 release notes]).

There are a few things we could do to avoid the error. We could open the editor again and change the JMX port as well, or we could disable 'Live Bean Support'. But probably we don't *really* want to run more than one copy of our app in this scenario. So we should just stop the already running instance before launching a new one. As this is such a common thing to do, STS provides a ![Relaunch] Toolbar Button for just this purpose. Click the Button, the running app is stopped and restarted with the changes you just made to the Launch Config now taking effect. If it worked you should now have a `404` error page at http://localhost:8888 instead of 8080. (Note: the Relaunch button won't work if you haven't launched anything yet because it works from your current session's launch history. However if you've launched an app at least once, it is okay to 'Relaunch' an app that is already terminated)

##Editing Configuration Poperties and Creating Profiles

Overriding default property values from the Launch Config editor is convenient for a 'quick change', but it probably isn't a great idea to rely on this to configure many properties and manage complex configurations. For this it is more convenient to manage properties in an 'application.properties' file. Or even several properties file defining different [Spring Profiles]. 

To help you edit such properties files STS 3.6.4 provides a brand new Spring Properties Editor. The editor provides nice content assist and error checking. 

This is the end of Part I. Still to come in Part II using the Spring Boot Property editor to edit 'application.properties' files and using @ConfigurationProperties annotations to enable property editor support for your own user-defined Boot-style properties. If you can't wait for Part II you can already read about these features right now in the [STS 3.6.4 release notes].

[menu-new-starter]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/menu-new-spring-starter.png
[new-starter-wizard]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/new-starter-wizard.png
[workspace-ready]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/workspace-ready.png
[run-as-boot]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/run-as-boot.png
[console-output]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/console-output.png
[Debug]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/debug-button.png
[Run]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/run-button.png
[Relaunch]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/relaunch-button.png
[run-conf-menu]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/run-conf-menu.png
[override-property]:https://raw.githubusercontent.com/kdvolder/spring-blog-2015-03/master/img/override-property.png



[Cloud Foundry]:http://cloudfoundry.org
[convert-jar-to-war]:https://spring.io/guides/gs/convert-jar-to-war/
[start.spring.io]:http://start.spring.io
[STS 3.6.4 release notes]:http://docs.spring.io/sts/nan/v364/NewAndNoteworthy.html
